<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mingxuan çš„ç‚¹æ­Œå°</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.0/papaparse.min.js"></script>
    <style>
        :root { --primary: #00aeec; }
        body { font-family: sans-serif; background: #f4f4f7; padding: 20px; }
        .box { max-width: 600px; margin: 0 auto; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .search { width: 100%; padding: 12px; border: 2px solid #eee; border-radius: 8px; box-sizing: border-box; font-size: 16px; margin-bottom: 15px; }
        .tags { margin-bottom: 15px; display: flex; gap: 8px; flex-wrap: wrap; }
        .tag { padding: 5px 12px; background: #eee; border-radius: 15px; font-size: 12px; cursor: pointer; border: none; }
        .tag.active { background: var(--primary); color: white; }
        .item { display: flex; justify-content: space-between; align-items: center; padding: 15px; border-bottom: 1px solid #f0f0f0; cursor: pointer; transition: 0.2s; }
        .item:hover { background: #f9f9f9; transform: translateX(5px); }
        .name { font-weight: bold; font-size: 16px; color: #333; }
        .info { font-size: 12px; color: #999; margin-top: 4px; }
        .badge { font-size: 10px; background: #e1f5fe; color: #01579b; padding: 2px 6px; border-radius: 4px; margin-left: 5px; }
        .copy-hint { font-size: 11px; color: var(--primary); border: 1px solid var(--primary); padding: 2px 8px; border-radius: 4px; }
        #toast { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.8); color: white; padding: 10px 20px; border-radius: 20px; display: none; z-index: 1000; }
    </style>
</head>
<body>

<div id="app" class="box">
    <h2 style="text-align: center;">ğŸµ æˆ‘çš„ç›´æ’­é—´æ­Œå•</h2>
    
    <input type="text" class="search" v-model="q" placeholder="æœç´¢æ­Œæ›²ã€æ­Œæ‰‹æˆ–å¤‡æ³¨...">
    
    <div class="tags">
        <button class="tag" :class="{active: !sg}" @click="sg=''">å…¨éƒ¨</button>
        <button class="tag" v-for="g in genres" :class="{active: sg===g}" @click="sg=g">{{g}}</button>
    </div>

    <div v-for="s in filtered" :key="s['Timestamp']" class="item" @click="copy(s['æ­Œæ›²åç§°'])">
        <div>
            <div class="name">
                {{s['æ­Œæ›²åç§°']}}
                <span v-if="s['ç±»å‹'] !== 'å…è´¹'" class="badge">{{s['ç±»å‹']}}</span>
            </div>
            <div class="info">{{s['æ­Œæ‰‹']}} Â· {{s['è¯­è¨€']}} Â· {{s['æ›²é£']}}</div>
        </div>
        <div class="copy-hint">ç‚¹å‡»å¤åˆ¶æ­Œå</div>
    </div>
    
    <div id="toast">å·²æˆåŠŸå¤åˆ¶æ­Œåï¼å¿«å»ç‚¹æ­Œå§~</div>
</div>

<script>
new Vue({
    el: '#app',
    data: { 
        q: '', 
        sg: '', 
        songs: [], 
        // å°†ä¸‹æ–¹é“¾æ¥æ›¿æ¢ä¸ºä½ ç”Ÿæˆçš„ Form Responses 1 çš„ CSV é“¾æ¥
        url: 'ä½ çš„_CSV_é“¾æ¥_åœ¨è¿™é‡Œ' 
    },
    computed: {
        genres() { 
            const all = this.songs.map(s => s['æ›²é£']).filter(g => g);
            return [...new Set(all)]; 
        },
        filtered() {
            return this.songs.filter(s => {
                const text = (s['æ­Œæ›²åç§°'] + s['æ­Œæ‰‹'] + (s['å¤‡æ³¨'] || '')).toLowerCase();
                const matchSearch = text.includes(this.q.toLowerCase());
                const matchGenre = this.sg ? s['æ›²é£'] === this.sg : true;
                return matchSearch && matchGenre;
            });
        }
    },
    mounted() {
        this.loadData();
    },
    methods: {
        loadData() {
            Papa.parse(this.url, {
                download: true, 
                header: true,
                complete: (res) => { 
                    // è¿‡æ»¤æ‰ç©ºè¡Œï¼Œå¹¶ç¡®ä¿åŒ¹é…ä½ çš„è¡¨å•å­—æ®µ
                    this.songs = res.data.filter(s => s['æ­Œæ›²åç§°']); 
                }
            });
        },
        copy(txt) {
            navigator.clipboard.writeText(txt).then(() => {
                const t = document.getElementById('toast');
                t.style.display = 'block';
                setTimeout(() => t.style.display = 'none', 2000);
            });
        }
    }
});
</script>
</body>
</html>